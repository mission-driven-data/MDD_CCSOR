if object_id('SmartDatePlus') is not null
drop table SmartDatePlus

select 
	_mdd_SmartDate.*
	,'No' as AgencyHoliday
into
	dbo.SmartDatePlus
from _mdd_SmartDate
where
	_mdd_SmartDate.thedate not in (
							select
								s.thedate
							from
								_mdd_SmartDate s
							where
								s.TheDate in (
										'7/4/2019',
										'9/2/2019',
										'11/28/2019',
										'11/29/2019',
										'12/25/2019',
										'12/26/2019',
										'1/1/2020',
										'1/20/2020',
										'2/17/2020',
										'5/25/2020',
										'6/19/2020',
										'7/3/2020',
										'9/7/2020',
										'11/26/2020',
										'11/27/2020',
										'12/25/2020',
										'12/28/2020',
										'1/1/2021',
										'1/18/2021',
										'2/15/2021',
										'5/31/2021',
										'6/18/2021',
										'7/5/2021',
										'9/6/2021',
										'11/25/2021',
										'11/26/2021',
										'12/24/2021',
										'12/27/2021',
										'12/31/2021',
										'1/17/2022',
										'2/21/2022',
										'5/30/2022',
										'6/20/2022',
										'7/4/2022',
										'9/5/2022',
										'11/24/2022',
										'11/25/2022',
										'12/26/2022',
										'12/27/2022',
										'1/2/2023',
										'1/16/2023',
										'2/20/2023',
										'5/29/2023',
										'6/19/2023',
										'7/4/2023',
										'9/4/2023',
										'11/23/2023',
										'11/24/2023',
										'12/25/2023',
										'12/26/2023',
										'1/1/2024',
										'1/15/2024',
										'2/29/2024',
										'5/27/2024',
										'6/19/2024',
										'7/4/2024',
										'9/2/2024',
										'11/28/2024',
										'11/29/2024',
										'12/25/2024',
										'12/26/2024',
										'1/1/2025',
										'1/20/2025',
										'2/17/2025',
										'5/26/2025',
										'6/19/2025',
										'7/4/2025',
										'9/1/2025',
										'11/27/2025',
										'11/28/2025',
										'2/25/2025',
										'12/26/2025',
										'1/1/2026',
										'1/19/2026',
										'2/16/2026',
										'5/25/2026',
										'6/19/2026',
										'7/3/2026',
										'9/7/2026',
										'11/26/2026',
										'11/27/2026',
										'12/25/2026',
										'12/28/2026',
										'1/1/2027',
										'1/18/2027',
										'2/15/2027',
										'5/31/2027',
										'6/19/2027',
										'7/5/2027',
										'9/6/2027',
										'11/25/2027',
										'11/26/2027',
										'12/24/2027',
										'12/27/2027',
										'12/31/2027',
										'1/17/2028',
										'2/21/2028',
										'5/29/2028',
										'6/19/2028',
										'7/4/2028',
										'9/4/2028',
										'11/23/2028',
										'11/24/2028',
										'12/25/2028',
										'12/26/2028',
										'1/1/2029',
										'1/15/2029',
										'2/19/2029',
										'5/28/2029',
										'6/19/2029',
										'7/4/2029',
										'9/3/2029',
										'11/22/2029',
										'11/23/2029',
										'12/25/2029',
										'12/26/2029',
										'12/1/2030',
										'1/21/2030',
										'2/18/2030',
										'5/27/2030',
										'6/19/2030',
										'7/4/2030',
										'9/2/2030',
										'11/28/2030',
										'11/29/2030',
										'12/25/2030',
										'12/26/2030',
										'1/1/2031',
										'1/20/2031',
										'2/17/2031',
										'5/26/2031',
										'6/19/2031',
										'1/1/2031',
										'9/1/2031',
										'11/27/2031',
										'11/28/2031',
										'12/25/2031',
										'12/26/2031',
										'1/1/2032',
										'1/19/2032',
										'2/16/2032',
										'5/31/2032',
										'6/18/2032',
										'7/5/2032',
										'9/6/2032',
										'11/25/2032',
										'11/26/2032',
										'12/24/2032',
										'12/27/2032',
										'12/31/2032',
										'1/17/2033',
										'2/21/2033',
										'5/30/2033',
										'6/20/2033',
										'7/4/2033',
										'9/5/2033',
										'11/24/2033',
										'11/25/2033',
										'12/26/2033',
										'12/27/2033',
										'1/2/2034',
										'1/16/2034',
										'2/20/2034',
										'5/29/2034',
										'6/19/2034',
										'7/4/2034',
										'9/4/2034',
										'11/23/2034',
										'11/24/2034',
										'12/25/2034',
										'12/26/2034',
										'1/1/2035',
										'1/15/2035',
										'2/19/2035',
										'5/28/2035',
										'6/19/2035',
										'7/4/2035',
										'9/3/2035',
										'11/22/2035',
										'11/23/2035',
										'12/25/2035',
										'12/26/2035',
										'1/1/2036',
										'1/21/2036',
										'2/18/2036',
										'5/26/2036',
										'6/19/2036',
										'7/4/2036',
										'1/1/2036',
										'11/27/2036',
										'11/28/2036',
										'12/25/2036',
										'12/26/2036',
										'1/1/2037',
										'1/19/2037',
										'2/16/2037',
										'5/25/2037',
										'6/19/2037',
										'7/3/2037',
										'9/7/2037',
										'11/26/2037',
										'11/27/2037',
										'12/25/2037',
										'12/28/2037',
										'1/1/2038',
										'1/18/2038',
										'2/15/2038')
								)
union

select
	s.*
	,'Yes' as AgencyHoliday 
from
	_mdd_SmartDate s
where s.thedate in (
										'7/4/2019',
										'9/2/2019',
										'11/28/2019',
										'11/29/2019',
										'12/25/2019',
										'12/26/2019',
										'1/1/2020',
										'1/20/2020',
										'2/17/2020',
										'5/25/2020',
										'6/19/2020',
										'7/3/2020',
										'9/7/2020',
										'11/26/2020',
										'11/27/2020',
										'12/25/2020',
										'12/28/2020',
										'1/1/2021',
										'1/18/2021',
										'2/15/2021',
										'5/31/2021',
										'6/18/2021',
										'7/5/2021',
										'9/6/2021',
										'11/25/2021',
										'11/26/2021',
										'12/24/2021',
										'12/27/2021',
										'12/31/2021',
										'1/17/2022',
										'2/21/2022',
										'5/30/2022',
										'6/20/2022',
										'7/4/2022',
										'9/5/2022',
										'11/24/2022',
										'11/25/2022',
										'12/26/2022',
										'12/27/2022',
										'1/2/2023',
										'1/16/2023',
										'2/20/2023',
										'5/29/2023',
										'6/19/2023',
										'7/4/2023',
										'9/4/2023',
										'11/23/2023',
										'11/24/2023',
										'12/25/2023',
										'12/26/2023',
										'1/1/2024',
										'1/15/2024',
										'2/29/2024',
										'5/27/2024',
										'6/19/2024',
										'7/4/2024',
										'9/2/2024',
										'11/28/2024',
										'11/29/2024',
										'12/25/2024',
										'12/26/2024',
										'1/1/2025',
										'1/20/2025',
										'2/17/2025',
										'5/26/2025',
										'6/19/2025',
										'7/4/2025',
										'9/1/2025',
										'11/27/2025',
										'11/28/2025',
										'2/25/2025',
										'12/26/2025',
										'1/1/2026',
										'1/19/2026',
										'2/16/2026',
										'5/25/2026',
										'6/19/2026',
										'7/3/2026',
										'9/7/2026',
										'11/26/2026',
										'11/27/2026',
										'12/25/2026',
										'12/28/2026',
										'1/1/2027',
										'1/18/2027',
										'2/15/2027',
										'5/31/2027',
										'6/19/2027',
										'7/5/2027',
										'9/6/2027',
										'11/25/2027',
										'11/26/2027',
										'12/24/2027',
										'12/27/2027',
										'12/31/2027',
										'1/17/2028',
										'2/21/2028',
										'5/29/2028',
										'6/19/2028',
										'7/4/2028',
										'9/4/2028',
										'11/23/2028',
										'11/24/2028',
										'12/25/2028',
										'12/26/2028',
										'1/1/2029',
										'1/15/2029',
										'2/19/2029',
										'5/28/2029',
										'6/19/2029',
										'7/4/2029',
										'9/3/2029',
										'11/22/2029',
										'11/23/2029',
										'12/25/2029',
										'12/26/2029',
										'12/1/2030',
										'1/21/2030',
										'2/18/2030',
										'5/27/2030',
										'6/19/2030',
										'7/4/2030',
										'9/2/2030',
										'11/28/2030',
										'11/29/2030',
										'12/25/2030',
										'12/26/2030',
										'1/1/2031',
										'1/20/2031',
										'2/17/2031',
										'5/26/2031',
										'6/19/2031',
										'1/1/2031',
										'9/1/2031',
										'11/27/2031',
										'11/28/2031',
										'12/25/2031',
										'12/26/2031',
										'1/1/2032',
										'1/19/2032',
										'2/16/2032',
										'5/31/2032',
										'6/18/2032',
										'7/5/2032',
										'9/6/2032',
										'11/25/2032',
										'11/26/2032',
										'12/24/2032',
										'12/27/2032',
										'12/31/2032',
										'1/17/2033',
										'2/21/2033',
										'5/30/2033',
										'6/20/2033',
										'7/4/2033',
										'9/5/2033',
										'11/24/2033',
										'11/25/2033',
										'12/26/2033',
										'12/27/2033',
										'1/2/2034',
										'1/16/2034',
										'2/20/2034',
										'5/29/2034',
										'6/19/2034',
										'7/4/2034',
										'9/4/2034',
										'11/23/2034',
										'11/24/2034',
										'12/25/2034',
										'12/26/2034',
										'1/1/2035',
										'1/15/2035',
										'2/19/2035',
										'5/28/2035',
										'6/19/2035',
										'7/4/2035',
										'9/3/2035',
										'11/22/2035',
										'11/23/2035',
										'12/25/2035',
										'12/26/2035',
										'1/1/2036',
										'1/21/2036',
										'2/18/2036',
										'5/26/2036',
										'6/19/2036',
										'7/4/2036',
										'1/1/2036',
										'11/27/2036',
										'11/28/2036',
										'12/25/2036',
										'12/26/2036',
										'1/1/2037',
										'1/19/2037',
										'2/16/2037',
										'5/25/2037',
										'6/19/2037',
										'7/3/2037',
										'9/7/2037',
										'11/26/2037',
										'11/27/2037',
										'12/25/2037',
										'12/28/2037',
										'1/1/2038',
										'1/18/2038',
										'2/15/2038')
								



